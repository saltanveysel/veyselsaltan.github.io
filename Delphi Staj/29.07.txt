http://www.delphiturkiye.com/forum/viewtopic.php?t=34965

resimdeki sorunu begin update endupdate ekleyerek gýdermeye calýstým fakat olmadý.daha sonra max'ý max-1 ayarlandý ama
bu sefer de olmadý cunku max degerýn yanlýs almýsým.

max-1 olacagýný



liste_gor.Items.BeginUpdate; eklendi
if blok.Count>blok2.Count düzelti
for i:=0 to max-1 do max-1 bulundu
for a:=i to max-1 do
                begin
                  if(Length(blok.Strings[a])<>Length(blok2.Strings[a]))
                  then begin
                  degisen:=IntToStr(a+1)+','+degisen;
                  end;
                end;
                  if Length(degisen)>1
                  then begin
                  degisen:=Copy(degisen,1,Length(degisen)-1);
                  end;
eklendi

liste_gor.Items.EndUpdate;eklendi



unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, WebAdapt, WebComp, ComCtrls;

type
  TForm1 = class(TForm)
    OpenDialog1: TOpenDialog;
    OpenDialog2: TOpenDialog;
    Button4: TButton;
    liste_gor: TListView;
    procedure Button4Click(Sender: TObject);
  private
    { Private declarations }
  procedure Compare(FileNameOne, FileNameTwo: string);
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}
Function aradansec( text, ilk, son:String ): String;
  begin
    Delete(Text, 1, pos(ilk, Text) + Length(ilk)-1);
    Result := Copy(Text, 1, Pos(Son, Text)-1);
  end;
procedure TForm1.Compare(FileNameOne, FileNameTwo: string);
 var
  List1,
  List2,
  blok,
  blok2,
  List2Yedek: TStringList;

  i,
  blok1uzunluk,
  blok2uzunluk,
  a,
  max: integer;

  procadi,
  procadi2,
  degisen:string;

  liste:TListItem;

begin
  try
    try
      List1 := TStringList.Create;
      List2 := TStringList.Create;
      blok := TStringList.Create;
      blok2 := TStringList.Create;
      List2Yedek:=TStringList.Create;
      List1.LoadFromFile(FileNameOne);
      List2.LoadFromFile(FileNameTwo);
      repeat
        blok.Text:=aradansec(List1.text,'CREATE PROCEDURE','END PROCEDURE');
        ShowMessage('1.'+blok.Text);
        blok1uzunluk:=Length(blok.Text);
        procadi:=aradansec(blok.Text,'"informix".','(' );
        List2Yedek.Text:=List2.Text;
        repeat
          degisen:='';
          blok2.Text:=aradansec(List2Yedek.Text,'CREATE PROCEDURE','END PROCEDURE');
          blok2uzunluk:=Length(blok2.Text);
          procadi2:=aradansec(blok2.Text,'"informix".','(' );
          if (blok1uzunluk<>blok2uzunluk) and (procadi=procadi2)
          then begin
            if blok.Count>blok2.Count
            then begin
            max:=blok.Count;
            end
            else
            begin
            max:=blok2.Count;
            end;
            for i:=0 to max-1 do
            begin
              if(Length(blok.Strings[i])<>Length(blok2.Strings[i]))
              then begin
                liste_gor.Items.BeginUpdate;
                liste:=liste_gor.Items.Add;
                liste.Caption:= procadi;
                for a:=i to max-1 do
                begin
                  if(Length(blok.Strings[a])<>Length(blok2.Strings[a]))
                  then begin
                  degisen:=IntToStr(a+1)+','+degisen;
                  end;
                end;
                  if Length(degisen)>1
                  then begin
                  degisen:=Copy(degisen,1,Length(degisen)-1);
                  end;
                liste.SubItems.Add(degisen);
                liste_gor.Items.EndUpdate;
                break;
              end;
            end;
          end;
        ShowMessage('2.'+blok2.Text);
          List2Yedek.Text:=Copy(List2Yedek.Text,Pos('END PROCEDURE',List2Yedek.Text)+1,Length(List2Yedek.Text));
        until Pos('END PROCEDURE',List2Yedek.Text)=0;
        List1.Text:=Copy(List1.Text,Pos('END PROCEDURE',List1.Text)+1,Length(List1.Text));
      until Pos('END PROCEDURE',List1.Text)=0;
    except
      ShowMessage('TStringList Oluþturulamadý!');
    end;
  finally
    List1.Free;
    List2.Free;
    blok.Free;
    blok2.Free;
    List2Yedek.Free;
  end;
end;
procedure TForm1.Button4Click(Sender: TObject);
 var
  old,
  new:string;
begin
  liste_gor.Clear;
  OpenDialog1.Title:='Eski Dosyayý Seçiniz';
    if OpenDialog1.Execute then
    begin
      old:=OpenDialog1.FileName;
    end;
  OpenDialog2.Title:='Yeni Dosyayý Seçiniz';
    if OpenDialog2.Execute then
    begin
      new:=OpenDialog2.FileName;
    end;
  Compare(old,new);
end;
end.